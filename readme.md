# [pm.by](https://pm.by/) | тестовое задание на позицию DevOps

## Задание

Разработать CI на базе Github Actions.

Приложение написано на Go, а в качестве базы используется Postgres.
На POST-запрос по `/` приложение сохраняет текущее время в базу,
а на GET-запрос - возвращает список сохраненных значений.

Помимо самого приложения в проекте присутствует документация,
которая поставляется в виде статического сайта.
Файлы документации располагаются в директории `/docs`.

Процесс разработки можно разбить на три этапа:

- разработка
- CI
- локальный stage

### Разработка

Разработчики тестируют свое приложение.
Для тестирования нужна локальная база данных.
Тесты запускаются командой `go test` из директории `./app`.

- [ ] обеспечить разработчику удобный способ запуска контейнера с базой
- [ ] обратить внимание на скорость выполнения тестов

Разработчики вносят изменения в схему базы данных (`assets/schema.sql`),
а также проверяют сборку образов на корректность и размер.

- [ ] предоставить инструкцию для сборки образа приложения и тестовых зависимостей
- [ ] обратить внимание на скорость сборки и размер итоговых образов

### CI

CI должен быть построен на базе Github Actions.
На каждый коммит должны выполняться:

- [ ] статический анализ кода с помощью `golangci-lint`
- [ ] тесты

Релиз-пайплайн должен публиковать образы приложения и зависимостей в registry
(выбор registry на ваше усмотрение).

- [ ] пайплайн запускается по тегу на коммит (тег по semver)
- [ ] образы публикуются в registry и помечаются релизным тегом (app:v0.0.1)
  > окружение состоит из нескольких образов,
  > все публикуются с одинаковым тегом

### Локальный stage

Frontend-команда запускает проект локально, образы скачивают из registry

- [ ] команда для старта окружения должна начинаться с `docker-compose up --no-build`
- [ ] приложение должно быть доступно по адресу `http://localhost`,
  а документация - `http://docs.localhost`
  > документация построена на базе [mkdocs-material](https://squidfunk.github.io/mkdocs-material/)
  > и должна поставляться в собственном контейнере.
- [ ] должен быть удобный и быстрый способ переключиться на другую версию окружения (по тегам)
- [ ] данные в базе должны храниться перманентно

## Примечание

Вы можете обнаружить неточности в постановке задачи или ошибки в самом приложении
— не стесняйтесь задавать уточняющие вопросы.

Проект шуточный, но просим обратить внимание на скорость выполнения,
размер образов, безопасность и удобство использования.

Если вы пожелаете наполнить пайплайн дополнительными фичами
(контроль покрытия кода тестами, работа с git-ветками или дополнительный анализ),
то, несомненно, это будет плюсом.

Если вы не знаете как реализовать какое-то требование — измените условия под себя,
измените код программы, добейтесь, чтобы оно работало.
Плохо сделанное задание в сто раз лучше, чем не сделанное.

## Справка

Запуск локальной версии документации:

```sh
cd docs
pip install -r requirements.txt
mkdocs serve
```

Сборка статического сайта с документацией:

```sh
mkdocs build
```

Скрипт инициализации базы находится в `assets/schema.sql`
